<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<h2 style="text-align: center">Power Monitoring System Data</h2>
<br/>
<form method = post th:action="@{/sortChart}">
    <div style="margin-left: 32%;display: inline-block;">
        <label for="start-datetime">Choose start datetime:</label>
        <br/>
        <input type="datetime-local" id="start-datetime"
               name="start-datetime" th:value="${start}" required>
    </div>
    <div style="display: inline-block; margin-left: 5%;">
        <label for="end-datetime"> Choose end datetime :</label>
        <br/>
        <input type="datetime-local" id="end-datetime"
               name="end-datetime" th:value="${end}" required>
        <button type="submit">Apply!</button>
    </div>
    <br/><br/><br/>
</form>
<div id="I1">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.I1}">
</div>
<div id="I2">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.I2}">
</div>
<div id="I3">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.I3}">
</div>
<div id="U1">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.U1}">
</div>
<div id="U2">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.U2}">
</div>
<div id="U3">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.U3}">
</div>
<div id="P">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.P}">
</div>
<div id="Q">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.Q}">
</div>
<div id="F">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.F}">
</div>
<div id="date">
    <input th:each="data : ${dataPointsList}" type="hidden" th:value="${data.datetime}">
</div>
<head>
    <script th:inline="javascript">
    /*<![CDATA[*/

  window.onload = function () {

        let value1 = document.getElementById('I1');
        let I1 = Array.from(value1.children).map(x => x.value);


        let value2 = document.getElementById('I2');
        let I2 = Array.from(value2.children).map(x => x.value);


        let value3 = document.getElementById('I3');
        let I3 = Array.from(value3.children).map(x => x.value);


        let value4 = document.getElementById('U1');
        let U1 = Array.from(value4.children).map(x => x.value);


        let value5 = document.getElementById('U2');
        let U2 = Array.from(value5.children).map(x => x.value);


        let value6 = document.getElementById('U3');
        let U3 = Array.from(value6.children).map(x => x.value);


        let value7 = document.getElementById('P');
        let P = Array.from(value7.children).map(x => x.value);


        let value8 = document.getElementById('Q');
        let Q = Array.from(value8.children).map(x => x.value);


        let value9 = document.getElementById('F');
        let F = Array.from(value9.children).map(x => x.value);


        let value10 = document.getElementById('date');
        let DateTime = Array.from(value10.children).map(x => x.value);

        var chart = new Chart("chartContainer",
        {
          type: "line",
          animationEnabled: true,
          theme: "light2",
          title:{
          text: "Multi-Series Line Chart"
          },
          data: {
            datasets: [
                {
                    data: I1,
                    borderColor: 'red',
                    label: 'I1'
                },
                {
                    data: I2,
                    borderColor: 'yellow',
                    label: 'I2'
                },
                {
                    data: I3,
                    borderColor: 'blue',
                    label: 'I3'
                },
                {
                    data: U1,
                    borderColor: 'gray',
                    label: 'U1'
                },
                {
                    data: U2,
                    borderColor: 'green',
                    label: 'U2'
                },
                {
                    data: U3,
                    borderColor: 'orange',
                    label: 'U3'
                },
                {
                    data: P,
                    borderColor: 'darkblue',
                    label: 'P'
                },
                {
                    data: Q,
                    borderColor: 'skyblue',
                    label: 'Q'
                },
                {
                    data: F,
                    borderColor: 'purple',
                    label: 'F'
                }
            ],
            labels: DateTime
          }

        });

        chart.render();
      }
  /*]]>*/
  </script>
    <script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
</head>
<body>
<canvas id="chartContainer" style="height: 300px; width: 100%;">
</canvas>
</body>
</html>